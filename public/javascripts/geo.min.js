var bb_successCallback,bb_errorCallback,bb_blackberryTimeout_id=-1;function handleBlackBerryLocationTimeout(){bb_blackberryTimeout_id!=-1&&bb_errorCallback({message:"Timeout error",code:3})}
function handleBlackBerryLocation(){clearTimeout(bb_blackberryTimeout_id);bb_blackberryTimeout_id=-1;if(bb_successCallback&&bb_errorCallback){if(blackberry.location.latitude==0&&blackberry.location.longitude==0)bb_errorCallback({message:"Position unavailable",code:2});else{var e=null;if(blackberry.location.timestamp)e=new Date(blackberry.location.timestamp);bb_successCallback({timestamp:e,coords:{latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}})}bb_errorCallback=bb_successCallback=
null}}
var geo_position_js=function(){var e={},c=null;e.getCurrentPosition=function(g,f,d){c.getCurrentPosition(g,f,d)};e.init=function(){try{if(typeof geo_position_js_simulator!="undefined")c=geo_position_js_simulator;else if(typeof bondi!="undefined"&&typeof bondi.geolocation!="undefined")c=bondi.geolocation;else if(typeof navigator.geolocation!="undefined"){c=navigator.geolocation;e.getCurrentPosition=function(f,d,a){c.getCurrentPosition(function(b){typeof b.latitude!="undefined"?f({timestamp:b.timestamp,coords:{latitude:b.latitude,
longitude:b.longitude}}):f(b)},d,a)}}else if(typeof window.google!="undefined"&&typeof google.gears!="undefined")c=google.gears.factory.create("beta.geolocation");else if(typeof Mojo!="undefined"&&typeof Mojo.Service.Request!="Mojo.Service.Request"){c=true;e.getCurrentPosition=function(f,d,a){parameters={};if(a){if(a.enableHighAccuracy&&a.enableHighAccuracy==true)parameters.accuracy=1;if(a.maximumAge)parameters.maximumAge=a.maximumAge;if(a.responseTime)if(a.responseTime<5)parameters.responseTime=
1;else if(a.responseTime<20)parameters.responseTime=2;else parameters.timeout=3}r=new Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:parameters,onSuccess:function(b){f({timestamp:b.timestamp,coords:{latitude:b.latitude,longitude:b.longitude,heading:b.heading}})},onFailure:function(b){if(b.errorCode==1)d({code:3,message:"Timeout"});else b.errorCode==2?d({code:2,message:"Position Unavailable"}):d({code:0,message:"Unknown Error: webOS-code"+errorCode})}})}}else if(typeof device!=
"undefined"&&typeof device.getServiceObject!="undefined"){c=device.getServiceObject("Service.Location","ILocation");e.getCurrentPosition=function(f,d){var a={};a.LocationInformationClass="BasicLocationInformation";c.ILocation.GetLocation(a,function(b,i,h){i==4?d({message:"Position unavailable",code:2}):f({timestamp:null,coords:{latitude:h.ReturnValue.Latitude,longitude:h.ReturnValue.Longitude,altitude:h.ReturnValue.Altitude,heading:h.ReturnValue.Heading}})})}}else if(typeof window.blackberry!="undefined"&&
blackberry.location.GPSSupported){if(typeof blackberry.location.setAidMode=="undefined")return false;blackberry.location.setAidMode(2);e.getCurrentPosition=function(f,d,a){bb_successCallback=f;bb_errorCallback=d;bb_blackberryTimeout_id=a.timeout?setTimeout("handleBlackBerryLocationTimeout()",a.timeout):setTimeout("handleBlackBerryLocationTimeout()",6E4);blackberry.location.onLocationUpdate("handleBlackBerryLocation()");blackberry.location.refreshLocation()};c=blackberry.location}}catch(g){alert("error="+
g);typeof console!="undefined"&&console.log(g);return false}return c!=null};return e}();