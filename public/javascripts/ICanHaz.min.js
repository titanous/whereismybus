(function(g){var n=function(){var h=function(){};h.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(a,c,b,d){if(!d){this.context=c;this.buffer=[]}if(!this.includes("",a))if(d)return a;else{this.send(a);return}a=this.render_pragmas(a);a=this.render_section(a,c,b);if(d)return this.render_tags(a,c,b,d);this.render_tags(a,c,b,d)},send:function(a){a!=""&&this.buffer.push(a)},render_pragmas:function(a){if(!this.includes("%",a))return a;
var c=this;return a.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(b,d,e){if(!c.pragmas_implemented[d])throw{message:"This implementation of mustache doesn't understand the '"+d+"' pragma"};c.pragmas[d]={};if(e){b=e.split("=");c.pragmas[d][b[0]]=b[1]}return""})},render_partial:function(a,c,b){a=this.trim(a);if(!b||b[a]===undefined)throw{message:"unknown_partial '"+a+"'"};if(typeof c[a]!="object")return this.render(b[a],c,b,true);return this.render(b[a],c[a],b,true)},render_section:function(a,
c,b){if(!this.includes("#",a)&&!this.includes("^",a))return a;var d=this;return a.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(e,i,j,k){e=d.find(j,c);if(i=="^")return!e||d.is_array(e)&&e.length===0?d.render(k,c,b,true):"";else if(i=="#")return d.is_array(e)?d.map(e,function(f){return d.render(k,d.create_context(f),b,true)}).join(""):d.is_object(e)?d.render(k,d.create_context(e),b,true):typeof e==="function"?
e.call(c,k,function(f){return d.render(f,c,b,true)}):e?d.render(k,c,b,true):""})},render_tags:function(a,c,b,d){var e=this,i=function(){return RegExp(e.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+e.ctag+"+","g")},j=i(),k=function(o,m,l){switch(m){case "!":return"";case "=":e.set_delimiters(l);j=i();return"";case ">":return e.render_partial(l,c,b);case "{":return e.find(l,c);default:return e.escape(e.find(l,c))}};a=a.split("\n");for(var f=0;f<a.length;f++){a[f]=a[f].replace(j,k,this);d||this.send(a[f])}if(d)return a.join("\n")},
set_delimiters:function(a){a=a.split(" ");this.otag=this.escape_regex(a[0]);this.ctag=this.escape_regex(a[1])},escape_regex:function(a){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return a.replace(arguments.callee.sRE,"\\$1")},find:function(a,c){a=this.trim(a);var b;if(c[a]===false||c[a]===0||c[a])b=c[a];else if(this.context[a]===false||this.context[a]===0||this.context[a])b=this.context[a];if(typeof b==="function")return b.apply(c);
if(b!==undefined)return b;return""},includes:function(a,c){return c.indexOf(this.otag+a)!=-1},escape:function(a){a=String(a===null?"":a);return a.replace(/&(?!\w+;)|["<>\\]/g,function(c){switch(c){case "&":return"&amp;";case "\\":return"\\\\";case '"':return'"';case "<":return"&lt;";case ">":return"&gt;";default:return c}})},create_context:function(a){if(this.is_object(a))return a;else{var c=".";if(this.pragmas["IMPLICIT-ITERATOR"])c=this.pragmas["IMPLICIT-ITERATOR"].iterator;var b={};b[c]=a;return b}},
is_object:function(a){return a&&typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},trim:function(a){return a.replace(/^\s*|\s*$/g,"")},map:function(a,c){if(typeof a.map=="function")return a.map(c);else{for(var b=[],d=a.length,e=0;e<d;e++)b.push(c(a[e]));return b}}};return{name:"mustache.js",version:"0.3.0",to_html:function(a,c,b,d){var e=new h;if(d)e.send=d;e.render(a,c,b);if(!d)return e.buffer.join("\n")}}}();window.ich=new function(){var h=this,
a={cache:{},partials:{}},c=String.prototype.trim;this.VERSION="0.8";this.addTemplate=function(b,d){if(this[b])throw"Can't add a template with reserved name: "+b+".";else if(a.cache.hasOwnProperty(b))throw"You've already got a template by the name: \""+b+'"';else{a.cache[b]=d;h[b]=function(e,i){e=e||{};var j=n.to_html(a.cache[b],e,a.partials);return i?j:g(j)}}};this.addPartial=function(b,d){if(a.partials.hasOwnProperty(b))throw'You\'ve already got a partial with the name: " + name + "';else a.partials[b]=
d};this.grabTemplates=function(){g('script[type="text/html"]').each(function(b){b=typeof b=="number"?g(this):g(b);var d=b.attr("id"),e=c?c.call(b.html()):g.trim(b.html());b.attr("class")&&b.attr("class").toLowerCase()==="partial"?h.addPartial(d,e):h.addTemplate(d,e);b.remove()})};this.showAll=function(){return{templates:g.extend({},a.cache),partials:g.extend({},a.partials)}};this.clearAll=function(){for(var b in a.cache)delete h[b];a.cache={};a.partials={}};this.refresh=function(){this.clearAll();
this.grabTemplates()}};g(function(){ich.grabTemplates()})})(this.jQuery||this.Zepto);